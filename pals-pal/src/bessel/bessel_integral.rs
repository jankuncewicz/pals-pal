//use std::f64::consts::PI;
#[path = "bessel_jn.rs"]
mod bessel;

/* 
const X: [f64; 10] = [
	-0.98768834059513772619,
	-0.8910065241883678623597,
	-0.7071067811865475244008,
	-0.45399049973954679156,
	-0.1564344650402308690101,
	0.1564344650402308690101,
	0.45399049973954679156,	
	0.7071067811865475244008,
	0.8910065241883678623597,
	0.98768834059513772619,
];

const WX: [f64; 10] = [
	6.392453221499666,
	2.2026892645852674,
	1.4142135623730951,
	1.1223262376343608,
	1.0124651257880029,
	1.0124651257880029,
	1.1223262376343608,
	1.4142135623730951,
	2.2026892645852674,
	6.392453221499666,
];

pub fn gauss(start: f64, end: f64, n: i32) -> f64{
	let mut ans = 0.0;
	let m = (end - start) / 2.0;
	let w = PI/10.;
	for i in 0..X.len() {
		ans += j((X[i]+1.)*m + start, n).re*WX[i];
	}
	if ans.is_nan() {
		return 0.0;
	}
	return m * w * ans;
}
*/

const X: [f64; 10] = [
	0.07652652113349733375,
	0.22778585114164507808,
	0.37370608871541956067,
	0.51086700195082709800,
	0.63605368072651502545,
	0.74633190646015079261,
	0.83911697182221882339,
	0.91223442825132590586,
	0.96397192727791379126,
	0.99312859918509492478,
];

const W: [f64; 10] = [
	0.15275338713072585069,
	0.14917298647260374678,
	0.14209610931838205132,
	0.13168863844917662689,
	0.11819453196151841731,
	0.10193011981724043503,
	0.08327674157670474872,
	0.06267204833410906357,
	0.04060142980038694133,
	0.01761400713915211831,
];

pub fn gauss(start: f64, end: f64, n: i32) -> f64{
	let mut ans = 0.0;
	let a = (start + end) / 2.0;
	let b = (end - start) / 2.0;
	for i in 0..W.len() {
		ans += W[i] * bessel::jn(n, b*X[i] + a).powi(2) * (b*X[i] + a);
		ans += W[i] * bessel::jn(n, -b*X[i] + a).powi(2) * (-b*X[i] + a);
	}
	if ans.is_nan() {
		return 0.0;
	}
	return b * ans;
}

//pub fn int_bessel(start: f64, end: f64, n: i32) -> f64 {
//	let mut ans = 0.0;
//	let mut now = start;
//	let mut startm = start;
//	loop {
//		now += 20.0;
//		if now >= end {
//			ans += gauss(startm, end, n);
//			break;
//		}
//		ans += gauss(startm, now, n);
//		startm = now;
//	}
//	return ans;
//}